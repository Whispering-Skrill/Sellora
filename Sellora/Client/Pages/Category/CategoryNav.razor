@*ASPNetr-yanWorks*@
@page "/categorynav/"
@inject HttpClient _client
@inject IJSRuntime js
@attribute [Authorize]
@inject HttpInterceptorService _interceptor
@implements IDisposable

<PageTitle>Categories</PageTitle>

<div class="category-topbar">
    <h2 class="category-title">Browse by Category</h2>
</div>

<div class="category-section">
    <div class="category-container">
        @if (Categories == null)
        {
            <div class="alert alert-info">Loading Categories...</div>
        }
        else
        {
            @foreach (var category in Categories)
            {
                <div class="category-box">
                    <a href="/listings/@category.Id" style="text-decoration:none;">
                        <div class="category-box-inner">
                            <h3 class="category-name">@category.CategoryName</h3>
                        </div>
                    </a>
                </div>
            }
        }
    </div>
</div>

@code {
    // Create a List based on Staff Table in Database
    private List<Category>? Categories;

    protected async override Task OnInitializedAsync()
    {
        _interceptor.MonitorEvent();
        Categories = await _client.GetFromJsonAsync<List<Category>>($"{Endpoints.CategoriesEndpoint}");
    }

    public void Dispose()
    {
        _interceptor.DisposeEvent();
    }
}
